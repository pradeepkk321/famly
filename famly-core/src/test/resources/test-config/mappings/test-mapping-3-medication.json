{
  "id": "medication-request-json-to-fhir-v1",
  "name": "MedicationRequest JSON to FHIR",
  "version": "1.0.0",
  "direction": "JSON_TO_FHIR",
  "sourceType": "MedicationRequestDTO",
  "targetType": "MedicationRequest",
  "fieldMappings": [
    {
      "id": "medreq-id",
      "sourcePath": "requestId",
      "targetPath": "identifier[0].value",
      "required": true
    },
    {
      "id": "medreq-id-system",
      "targetPath": "identifier[0].system",
      "defaultValue": "http://hospital.org/medication-requests",
      "required": true
    },
    {
      "id": "medreq-status",
      "sourcePath": "status",
      "targetPath": "status",
      "lookupTable": "medication-request-status-lookup",
      "required": true
    },
    {
      "id": "medreq-intent",
      "sourcePath": "intent",
      "targetPath": "intent",
      "lookupTable": "medication-request-intent-lookup",
      "required": true
    },
    {
      "id": "medreq-priority",
      "sourcePath": "priority",
      "targetPath": "priority",
      "lookupTable": "medication-request-priority-lookup"
    },
    {
      "id": "medreq-subject",
      "sourcePath": "patientId",
      "targetPath": "subject.reference",
      "transformExpression": "fn.concat('Patient/', value)",
      "required": true
    },
    {
      "id": "medreq-encounter",
      "sourcePath": "encounterId",
      "targetPath": "encounter.reference",
      "transformExpression": "fn.concat('Encounter/', value)",
      "condition": "encounterId != null"
    },
    {
      "id": "medreq-medication-code",
      "sourcePath": "medicationCode",
      "targetPath": "medicationCodeableConcept.coding[0].code",
      "required": true
    },
    {
      "id": "medreq-medication-system",
      "targetPath": "medicationCodeableConcept.coding[0].system",
      "defaultValue": "http://www.nlm.nih.gov/research/umls/rxnorm",
      "required": true
    },
    {
      "id": "medreq-medication-display",
      "sourcePath": "medicationName",
      "targetPath": "medicationCodeableConcept.coding[0].display"
    },
    {
      "id": "medreq-medication-text",
      "sourcePath": "medicationName",
      "targetPath": "medicationCodeableConcept.text"
    },
    {
      "id": "medreq-authored-on",
      "sourcePath": "requestedDate",
      "targetPath": "authoredOn",
      "dataType": "date"
    },
    {
      "id": "medreq-dosage-text",
      "sourcePath": "dosageText",
      "targetPath": "dosageInstruction[0].text"
    },
    {
      "id": "medreq-dosage-route-code",
      "sourcePath": "route",
      "targetPath": "dosageInstruction[0].route.coding[0].code",
      "lookupTable": "route-lookup"
    },
    {
      "id": "medreq-dosage-route-system",
      "targetPath": "dosageInstruction[0].route.coding[0].system",
      "defaultValue": "http://snomed.info/sct",
      "condition": "route != null"
    },
    {
      "id": "medreq-dosage-timing-code",
      "sourcePath": "frequency",
      "targetPath": "dosageInstruction[0].timing.code.coding[0].code",
      "lookupTable": "timing-lookup"
    },
    {
      "id": "medreq-dosage-timing-system",
      "targetPath": "dosageInstruction[0].timing.code.coding[0].system",
      "defaultValue": "http://terminology.hl7.org/CodeSystem/v3-GTSAbbreviation",
      "condition": "frequency != null"
    },
    {
      "id": "medreq-dispense-quantity-value",
      "sourcePath": "quantityValue",
      "targetPath": "dispenseRequest.quantity.value",
      "dataType": "decimal"
    },
    {
      "id": "medreq-dispense-quantity-unit",
      "sourcePath": "quantityUnit",
      "targetPath": "dispenseRequest.quantity.unit"
    },
    {
      "id": "medreq-dispense-quantity-system",
      "targetPath": "dispenseRequest.quantity.system",
      "defaultValue": "http://unitsofmeasure.org",
      "condition": "quantityValue != null"
    },
    {
      "id": "medreq-dispense-refills",
      "sourcePath": "refills",
      "targetPath": "dispenseRequest.numberOfRepeatsAllowed",
      "dataType": "integer"
    },
    {
      "id": "medreq-substitution-allowed",
      "sourcePath": "substitutionAllowed",
      "targetPath": "substitution.allowedBoolean",
      "dataType": "boolean"
    },
    {
      "id": "medreq-reason-code-0-code",
      "sourcePath": "reasonCodes[0]",
      "targetPath": "reasonCode[0].coding[0].code",
      "condition": "reasonCodes != null && reasonCodes.size() > 0"
    },
    {
      "id": "medreq-reason-code-0-system",
      "targetPath": "reasonCode[0].coding[0].system",
      "defaultValue": "http://hl7.org/fhir/sid/icd-10",
      "condition": "reasonCodes != null && reasonCodes.size() > 0"
    },
    {
      "id": "medreq-reason-code-0-display",
      "sourcePath": "reasonTexts[0]",
      "targetPath": "reasonCode[0].coding[0].display",
      "condition": "reasonTexts != null && reasonTexts.size() > 0"
    },
    {
      "id": "medreq-reason-code-1-code",
      "sourcePath": "reasonCodes[1]",
      "targetPath": "reasonCode[1].coding[0].code",
      "condition": "reasonCodes != null && reasonCodes.size() > 1"
    },
    {
      "id": "medreq-reason-code-1-system",
      "targetPath": "reasonCode[1].coding[0].system",
      "defaultValue": "http://hl7.org/fhir/sid/icd-10",
      "condition": "reasonCodes != null && reasonCodes.size() > 1"
    },
    {
      "id": "medreq-reason-code-1-display",
      "sourcePath": "reasonTexts[1]",
      "targetPath": "reasonCode[1].coding[0].display",
      "condition": "reasonTexts != null && reasonTexts.size() > 1"
    },
    {
      "id": "medreq-note-0",
      "sourcePath": "notes[0]",
      "targetPath": "note[0].text",
      "condition": "notes != null && notes.size() > 0"
    },
    {
      "id": "medreq-note-1",
      "sourcePath": "notes[1]",
      "targetPath": "note[1].text",
      "condition": "notes != null && notes.size() > 1"
    }
  ]
}