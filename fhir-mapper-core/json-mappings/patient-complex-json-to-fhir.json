{
  "id" : "patient-complex-json-to-fhir-v1",
  "name" : "Complex Patient JSON to FHIR Mapping",
  "sourceType" : "ComplexPatientDTO",
  "targetType" : "Patient",
  "version" : "1.0.0",
  "direction" : "JSON_TO_FHIR",
  "fieldMappings" : [ {
    "id" : "patient-mrn",
    "sourcePath" : "patientId",
    "targetPath" : "identifier[0].value",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "",
    "validator" : "",
    "required" : true,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : "Medical Record Number"
  }, {
    "id" : "patient-mrn-system",
    "sourcePath" : "",
    "targetPath" : "identifier[0].system",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "",
    "validator" : "",
    "required" : true,
    "defaultValue" : "$ctx.settings['mrnSystem']",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-mrn-type-code",
    "sourcePath" : "",
    "targetPath" : "identifier[0].type.coding[0].code",
    "dataType" : "code",
    "transformExpression" : "",
    "condition" : "",
    "validator" : "",
    "required" : true,
    "defaultValue" : "MR",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-mrn-type-system",
    "sourcePath" : "",
    "targetPath" : "identifier[0].type.coding[0].system",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "",
    "validator" : "",
    "required" : true,
    "defaultValue" : "http://terminology.hl7.org/CodeSystem/v2-0203",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-ssn",
    "sourcePath" : "ssn",
    "targetPath" : "identifier[1].value",
    "dataType" : "string",
    "transformExpression" : "fn:replace(value, '-', '')",
    "condition" : "ssn != null && ssn != ''",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : "SSN without dashes"
  }, {
    "id" : "patient-ssn-system",
    "sourcePath" : "",
    "targetPath" : "identifier[1].system",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "ssn != null && ssn != ''",
    "validator" : "",
    "required" : false,
    "defaultValue" : "http://hl7.org/fhir/sid/us-ssn",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-ssn-type-code",
    "sourcePath" : "",
    "targetPath" : "identifier[1].type.coding[0].code",
    "dataType" : "code",
    "transformExpression" : "",
    "condition" : "ssn != null && ssn != ''",
    "validator" : "",
    "required" : false,
    "defaultValue" : "SS",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-name-use",
    "sourcePath" : "",
    "targetPath" : "name[0].use",
    "dataType" : "code",
    "transformExpression" : "",
    "condition" : "",
    "validator" : "",
    "required" : true,
    "defaultValue" : "official",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-name-family",
    "sourcePath" : "lastName",
    "targetPath" : "name[0].family",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "",
    "validator" : "",
    "required" : true,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-name-given-first",
    "sourcePath" : "firstName",
    "targetPath" : "name[0].given[0]",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "",
    "validator" : "",
    "required" : true,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-name-given-middle",
    "sourcePath" : "middleName",
    "targetPath" : "name[0].given[1]",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "middleName != null && middleName != ''",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-name-suffix",
    "sourcePath" : "suffix",
    "targetPath" : "name[0].suffix[0]",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "suffix != null && suffix != ''",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-gender",
    "sourcePath" : "gender",
    "targetPath" : "gender",
    "dataType" : "code",
    "transformExpression" : "",
    "condition" : "",
    "validator" : "",
    "required" : true,
    "defaultValue" : "",
    "lookupTable" : "gender-lookup",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-birthdate",
    "sourcePath" : "dateOfBirth",
    "targetPath" : "birthDate",
    "dataType" : "date",
    "transformExpression" : "",
    "condition" : "",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-marital-status",
    "sourcePath" : "maritalStatus",
    "targetPath" : "maritalStatus.coding[0].code",
    "dataType" : "code",
    "transformExpression" : "",
    "condition" : "",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "marital-status-lookup",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-marital-status-system",
    "sourcePath" : "",
    "targetPath" : "maritalStatus.coding[0].system",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "maritalStatus != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "http://terminology.hl7.org/CodeSystem/v3-MaritalStatus",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-deceased-boolean",
    "sourcePath" : "demographics.deceasedFlag",
    "targetPath" : "deceasedBoolean",
    "dataType" : "boolean",
    "transformExpression" : "",
    "condition" : "",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-address-home-use",
    "sourcePath" : "addresses[0].type",
    "targetPath" : "address[0].use",
    "dataType" : "code",
    "transformExpression" : "",
    "condition" : "addresses != null && addresses.size() > 0",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "address-use-lookup",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-address-home-line1",
    "sourcePath" : "addresses[0].line1",
    "targetPath" : "address[0].line[0]",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "addresses != null && addresses.size() > 0",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-address-home-line2",
    "sourcePath" : "addresses[0].line2",
    "targetPath" : "address[0].line[1]",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "addresses != null && addresses.size() > 0 && addresses[0].line2 != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-address-home-city",
    "sourcePath" : "addresses[0].city",
    "targetPath" : "address[0].city",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "addresses != null && addresses.size() > 0",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-address-home-state",
    "sourcePath" : "addresses[0].state",
    "targetPath" : "address[0].state",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "addresses != null && addresses.size() > 0",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-address-home-zip",
    "sourcePath" : "addresses[0].zip",
    "targetPath" : "address[0].postalCode",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "addresses != null && addresses.size() > 0",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-address-home-country",
    "sourcePath" : "addresses[0].country",
    "targetPath" : "address[0].country",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "addresses != null && addresses.size() > 0",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-telecom-mobile-system",
    "sourcePath" : "",
    "targetPath" : "telecom[0].system",
    "dataType" : "code",
    "transformExpression" : "",
    "condition" : "contacts != null && contacts.size() > 0",
    "validator" : "",
    "required" : false,
    "defaultValue" : "phone",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-telecom-mobile-value",
    "sourcePath" : "contacts[0].value",
    "targetPath" : "telecom[0].value",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "contacts != null && contacts.size() > 0",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-telecom-mobile-use",
    "sourcePath" : "contacts[0].type",
    "targetPath" : "telecom[0].use",
    "dataType" : "code",
    "transformExpression" : "",
    "condition" : "contacts != null && contacts.size() > 0",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "telecom-use-lookup",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-telecom-email-system",
    "sourcePath" : "",
    "targetPath" : "telecom[1].system",
    "dataType" : "code",
    "transformExpression" : "",
    "condition" : "contacts != null && contacts.size() > 2",
    "validator" : "",
    "required" : false,
    "defaultValue" : "email",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-telecom-email-value",
    "sourcePath" : "contacts[2].value",
    "targetPath" : "telecom[1].value",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "contacts != null && contacts.size() > 2",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-language-code",
    "sourcePath" : "preferredLanguage",
    "targetPath" : "communication[0].language.coding[0].code",
    "dataType" : "code",
    "transformExpression" : "",
    "condition" : "preferredLanguage != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "language-lookup",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-language-system",
    "sourcePath" : "",
    "targetPath" : "communication[0].language.coding[0].system",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "preferredLanguage != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "urn:ietf:bcp:47",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-language-preferred",
    "sourcePath" : "",
    "targetPath" : "communication[0].preferred",
    "dataType" : "boolean",
    "transformExpression" : "",
    "condition" : "preferredLanguage != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "true",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-race-ombCategory-code",
    "sourcePath" : "race",
    "targetPath" : "extension[0].extension[0].valueCoding.code",
    "dataType" : "code",
    "transformExpression" : "",
    "condition" : "race != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-race-ombCategory-system",
    "sourcePath" : "",
    "targetPath" : "extension[0].extension[0].valueCoding.system",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "race != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "urn:oid:2.16.840.1.113883.6.238",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-race-ombCategory-url",
    "sourcePath" : "",
    "targetPath" : "extension[0].extension[0].url",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "race != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "ombCategory",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-race-text",
    "sourcePath" : "race",
    "targetPath" : "extension[0].extension[1].valueString",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "race != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "race-text-lookup",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-race-text-url",
    "sourcePath" : "",
    "targetPath" : "extension[0].extension[1].url",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "race != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "text",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-race-url",
    "sourcePath" : "",
    "targetPath" : "extension[0].url",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "race != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "http://hl7.org/fhir/us/core/StructureDefinition/us-core-race",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-ethnicity-ombCategory-code",
    "sourcePath" : "ethnicity",
    "targetPath" : "extension[1].extension[0].valueCoding.code",
    "dataType" : "code",
    "transformExpression" : "",
    "condition" : "ethnicity != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-ethnicity-ombCategory-system",
    "sourcePath" : "",
    "targetPath" : "extension[1].extension[0].valueCoding.system",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "ethnicity != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "urn:oid:2.16.840.1.113883.6.238",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-ethnicity-ombCategory-url",
    "sourcePath" : "",
    "targetPath" : "extension[1].extension[0].url",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "ethnicity != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "ombCategory",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-ethnicity-text",
    "sourcePath" : "ethnicity",
    "targetPath" : "extension[1].extension[1].valueString",
    "dataType" : "string",
    "transformExpression" : "",
    "condition" : "ethnicity != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "ethnicity-text-lookup",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-ethnicity-text-url",
    "sourcePath" : "",
    "targetPath" : "extension[1].extension[1].url",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "ethnicity != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "text",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-ethnicity-url",
    "sourcePath" : "",
    "targetPath" : "extension[1].url",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "ethnicity != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "http://hl7.org/fhir/us/core/StructureDefinition/us-core-ethnicity",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-birthsex-code",
    "sourcePath" : "demographics.birthSex",
    "targetPath" : "extension[2].valueCode",
    "dataType" : "code",
    "transformExpression" : "",
    "condition" : "demographics != null && demographics.birthSex != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "birth-sex-lookup",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-birthsex-url",
    "sourcePath" : "",
    "targetPath" : "extension[2].url",
    "dataType" : "uri",
    "transformExpression" : "",
    "condition" : "demographics != null && demographics.birthSex != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  }, {
    "id" : "patient-managing-org",
    "sourcePath" : "",
    "targetPath" : "managingOrganization.reference",
    "dataType" : "string",
    "transformExpression" : "fn.concat('Organization/', organizationId)",
    "condition" : "organizationId != null",
    "validator" : "",
    "required" : false,
    "defaultValue" : "",
    "lookupTable" : "",
    "lookupSourceField" : null,
    "description" : ""
  } ]
}